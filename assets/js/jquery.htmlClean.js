(function(c){function w(a,b,c,k){if(!a.tag.isInline&&0<c.length)for(c.push("\n"),i=0;i<k;i++)c.push("\t")}function z(a,b){var d=[],k=0==a.attributes.length,f;if(a.tag.isComment)b.allowComments&&(d.push("\x3c!--"),d.push(a.tag.rawAttributes),d.push(">"),b.format&&w(a,b,d,f-1));else{this.name.concat(void 0==a.tag.rawAttributes?"":a.tag.rawAttributes);var n=a.tag.render&&(0==b.allowedTags.length||-1<c.inArray(a.tag.name,b.allowedTags))&&(0==b.removeTags.length||-1==c.inArray(a.tag.name,b.removeTags));
!a.isRoot&&n&&(d.push("<"),d.push(a.tag.name),c.each(a.attributes,function(){if(-1==c.inArray(this.name,b.removeAttrs)){var f=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value),e=f[2],f=f[1]||"'";"class"==this.name&&0<b.allowedClasses.length&&(e=c.grep(e.split(" "),function(d){return 0<c.grep(b.allowedClasses,function(b){return b==d||b[0]==d&&(1==b.length||-1<c.inArray(a.tag.name,b[1]))}).length}).join(" "));null!=e&&(0<e.length||-1<c.inArray(this.name,a.tag.requiredAttributes))&&(d.push(" "),d.push(this.name),
d.push("="),d.push(f),d.push(e),d.push(f))}}));if(a.tag.isSelfClosing)n&&d.push(" />"),k=!1;else if(a.tag.isNonClosing)k=!1;else{!a.isRoot&&n&&d.push(">");f=b.formatIndent++;if(a.tag.toProtect){var e=c.htmlClean.trim(a.children.join("")).replace(/<br>/ig,"\n");d.push(e);k=0==e.length}else{for(var e=[],h=0;h<a.children.length;h++){var l=a.children[h],g=c.htmlClean.trim(x(t(l)?l:l.childrenToString()));F(l)&&0<h&&0<g.length&&(G(l)||H(a.children[h-1]))&&e.push(" ");if(t(l))0<g.length&&e.push(g);else if(h!=
a.children.length-1||"br"!=l.tag.name)b.format&&w(l,b,e,f),e=e.concat(z(l,b))}b.formatIndent--;0<e.length&&(b.format&&"\n"!=e[0]&&w(a,b,d,f),d=d.concat(e),k=!1)}!a.isRoot&&n&&(b.format&&w(a,b,d,f-1),d.push("</"),d.push(a.tag.name),d.push(">"))}if(!a.tag.allowEmpty&&k)return[]}return d}function A(a,b){return y(a,function(a){return-1<c.inArray(a.tag.nameOriginal,b)})}function I(a){return y(a,function(a){return a.isRoot||!a.tag.isInline})}function y(a,b,c){c=c||1;return b(a[a.length-c])?!0:0<a.length-
c&&y(a,b,c+1)?(a.pop(),!0):!1}function u(a){a?(this.tag=a,this.isRoot=!1):(this.tag=new v("root"),this.isRoot=!0);this.attributes=[];this.children=[];this.hasAttribute=function(a){for(var c=0;c<this.attributes.length;c++)if(this.attributes[c].name==a)return!0;return!1};this.childrenToString=function(){return this.children.join("")};return this}function B(a,b){this.name=a;this.value=b;return this}function v(a,b,d,k){this.nameOriginal=this.name=a.toLowerCase();this.render=!0;this.init=function(){"--"==
this.name?this.isSelfClosing=this.isComment=!0:(this.isComment=!1,this.isSelfClosing=-1<c.inArray(this.name,J),this.isNonClosing=-1<c.inArray(this.name,K),this.isClosing=void 0!=b&&0<b.length,this.isInline=-1<c.inArray(this.name,L),this.disallowNest=-1<c.inArray(this.name,M),this.requiredParent=C[c.inArray(this.name,C)+1],this.allowEmpty=-1<c.inArray(this.name,N),this.toProtect=-1<c.inArray(this.name,O));this.rawAttributes=d;this.requiredAttributes=D[c.inArray(this.name,D)+1];if(k){k.tagAttributesCache||
(k.tagAttributesCache=[]);if(-1==c.inArray(this.name,k.tagAttributesCache)){for(var a=E[c.inArray(this.name,E)+1].slice(0),n=0;n<k.allowedAttributes.length;n++){var e=k.allowedAttributes[n][0];(1==k.allowedAttributes[n].length||-1<c.inArray(this.name,k.allowedAttributes[n][1]))&&-1==c.inArray(e,a)&&a.push(e)}k.tagAttributesCache.push(this.name);k.tagAttributesCache.push(a)}this.allowedAttributes=k.tagAttributesCache[c.inArray(this.name,k.tagAttributesCache)+1]}};this.init();this.rename=function(a){this.name=
a;this.init()};return this}function G(a){for(;a.constructor==u&&0<a.children.length;)a=a.children[0];if(!t(a))return!1;a=x(a);return 0<a.length&&c.htmlClean.isWhitespace(a.charAt(0))}function H(a){for(;a.constructor==u&&0<a.children.length;)a=a.children[a.children.length-1];if(!t(a))return!1;a=x(a);return 0<a.length&&c.htmlClean.isWhitespace(a.charAt(a.length-1))}function t(a){return a.constructor==String}function F(a){return t(a)||a.tag.isInline}function x(a){return a.replace(/&nbsp;|\n/g," ").replace(/\s\s+/g,
" ")}c.fn.htmlClean=function(a){return this.each(function(){c(this);this.value?this.value=c.htmlClean(this.value,a):this.innerHTML=c.htmlClean(this.innerHTML,a)})};c.htmlClean=function(a,b){b=c.extend({},c.htmlClean.defaults,b);var d=/(<(\/)?(\w+:)?([\w]+)([^>]*)>)|\x3c!--(.*?--)>/gi,k=/([\w\-]+)=(".*?"|'.*?'|[^\s>]*)/gi,f,n=new u,e=[n],h=n;b.bodyOnly&&(f=/<body[^>]*>((\n|.)*)<\/body>/i.exec(a))&&(a=f[1]);a=a.concat("<xxx>");for(var l;f=d.exec(a);){var g=f[6]?new v("--",null,f[6],b):new v(f[4],f[2],
f[5],b);l=a.substring(l,f.index);if(0<l.length){var m=h.children[h.children.length-1];0<h.children.length&&t(m=h.children[h.children.length-1])?h.children[h.children.length-1]=m.concat(l):h.children.push(l)}l=d.lastIndex;if(g.isClosing)A(e,[g.name])&&(e.pop(),h=e[e.length-1]);else{for(var p=new u(g);m=k.exec(g.rawAttributes);){if("style"==m[1].toLowerCase()&&b.replaceStyles)for(var q=!g.isInline,r=0;r<b.replaceStyles.length;r++)b.replaceStyles[r][0].test(m[2])&&(q||(g.render=!1,q=!0),h.children.push(p),
e.push(p),h=p,g=new v(b.replaceStyles[r][1],"","",b),p=new u(g));null!=g.allowedAttributes&&(0==g.allowedAttributes.length||-1<c.inArray(m[1],g.allowedAttributes))&&p.attributes.push(new B(m[1],m[2]))}c.each(g.requiredAttributes,function(){var a=this.toString();p.hasAttribute(a)||p.attributes.push(new B(a,""))});for(m=0;m<b.replace.length;m++)for(q=0;q<b.replace[m][0].length;q++)if((r="string"==typeof b.replace[m][0][q])&&b.replace[m][0][q]==g.name||!r&&b.replace[m][0][q].test(f)){g.rename(b.replace[m][1]);
m=b.replace.length;break}f=!0;if(!h.isRoot)if(h.tag.isInline&&!g.isInline){if(f=I(e))h=e[e.length-1]}else h.tag.disallowNest&&g.disallowNest&&!g.requiredParent?f=!1:g.requiredParent&&(f=A(e,g.requiredParent))&&(h=e[e.length-1]);if(f)if(h.children.push(p),g.toProtect)for(;tagMatch2=d.exec(a);){if(f=new v(tagMatch2[3],tagMatch2[1],tagMatch2[4],b),f.isClosing&&f.name==g.name){p.children.push(RegExp.leftContext.substring(l));l=d.lastIndex;break}}else g.isSelfClosing||g.isNonClosing||(e.push(p),h=p)}}return c.htmlClean.trim(z(n,
b).join(""))};c.htmlClean.defaults={bodyOnly:!0,allowedTags:[],removeTags:"basefont center dir font frame frameset iframe isindex menu noframes s strike u".split(" "),allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:!1,formatIndent:0,replace:[[["b","big"],"strong"],[["i"],"em"]],replaceStyles:[[/font-weight:\s*bold/i,"strong"],[/font-style:\s*italic/i,"em"],[/vertical-align:\s*super/i,"sup"],[/vertical-align:\s*sub/i,"sub"]],allowComments:!1};c.htmlClean.trim=function(a){return c.htmlClean.trimStart(c.htmlClean.trimEnd(a))};
c.htmlClean.trimStart=function(a){return a.substring(c.htmlClean.trimStartIndex(a))};c.htmlClean.trimStartIndex=function(a){for(var b=0;b<a.length-1&&c.htmlClean.isWhitespace(a.charAt(b));b++);return b};c.htmlClean.trimEnd=function(a){return a.substring(0,c.htmlClean.trimEndIndex(a))};c.htmlClean.trimEndIndex=function(a){for(var b=a.length-1;0<=b&&c.htmlClean.isWhitespace(a.charAt(b));b--);return b+1};c.htmlClean.isWhitespace=function(a){return-1!=c.inArray(a,P)};var L="a abbr acronym address b big br button caption cite code del em font hr i input img ins label legend map q s samp select option param small span strike strong sub sup tt u var".split(" "),
M="h1 h2 h3 h4 h5 h6 p th td object".split(" "),N=["th","td"],C=[null,"li",["ul","ol"],"dt",["dl"],"dd",["dl"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"],"param",["object"]],O=["script","style","pre","code"],J="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),K=["!doctype","?xml"],E=[["class"],"?xml",[],"!doctype",[],"a","accesskey class href name title rel rev type tabindex".split(" "),
"abbr",["class","title"],"acronym",["class","title"],"blockquote",["cite","class"],"button",["class","disabled","name","type","value"],"del",["cite","class","datetime"],"form","accept action class enctype method name".split(" "),"input","accept accesskey alt checked class disabled ismap maxlength name size readonly src tabindex type usemap value".split(" "),"img",["alt","class","height","src","width"],"ins",["cite","class","datetime"],"label",["accesskey","class","for"],"legend",["accesskey","class"],
"link",["href","rel","type"],"meta",["content","http-equiv","name","scheme","charset"],"map",["name"],"optgroup",["class","disabled","label"],"option",["class","disabled","label","selected","value"],"q",["class","cite"],"script",["src","type"],"select","class disabled multiple name size tabindex".split(" "),"style",["type"],"table",["class","summary"],"th",["class","colspan","rowspan"],"td",["class","colspan","rowspan"],"textarea","accesskey class cols disabled name readonly rows tabindex".split(" "),
"param",["name","value"],"embed",["height","src","type","width"]],D=[[],"img",["alt"]],P="\u00a0 \t\n\r\f".split("")})(jQuery);